<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="utf-8" />
    <title>异步（预加载）加载图片</title>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1.0" />
</head>
<body>

<div onclick="as()">asa</div>
<!--<img src="http://web.2008php.com/2014_Website_appreciate/2014-10-31/20141031133134.jpg">-->
<!--<img src="http://web.2008php.com/2014_Website_appreciate/2014-10-31/20141031133134.jpg">-->
<!--<img src="http://web.2008php.com/2014_Website_appreciate/2014-10-31/20141031133134.jpg">-->
<!--<img src="http://web.2008php.com/2014_Website_appreciate/2014-10-31/20141031133134.jpg">-->

<img src="图片1.png" id="display_images">


<script type="text/javascript">

    function loadImage(id,src,callback)
    {
        var imgloader= new window.Image();
        //当图片成功加载到浏览器缓存
        imgloader.onload =function(evt)
        {
            if(typeof(imgloader.readyState)=='undefined')
            {
                imgloader.readyState = 'undefined';
            }
            //在IE8以及以下版本中需要判断readyState而不是complete
            if ((imgloader.readyState=='complete'||imgloader.readyState=="loaded")||imgloader.complete)
            {
                console.log('width='+imgloader.width+',height='+imgloader.height);//读取原始图片大小
                callback({'msg':'ok','src':src,'id':id});

            }else{
                imgloader.onreadystatechange(evt);
            }
        };

        imgloader.onerror = function(evt)
        {
            callback({'msg':'error','id':id});
        };

        imgloader.onreadystatechange = function(e)
        {
            //此方法只有IE8以及一下版本会调用
        };
        imgloader.src=src;
    }

    var loadResult = function(data)
    {
        data =	data ||{} ;
        if(typeof(data.msg)!='undefined')
        {
            if(data.msg=='ok')
            {
                //这里使用了id获取元素，有点死板，建议读者自行扩展为css 选择符
                document.getElementById(''+data.id).src=data.src;

            }else{
                //这里图片加载失败，我们可以显示其他图片，防止大红叉
                document.getElementById(''+data.id).src='图2.jpg';
            }
        }
    }

    var surl = 'http://web.2008php.com/2014_Website_appreciate/2014-10-31/20141031133134.jpg';

    loadImage('display_images',surl,loadResult);
</script>
<script src="1.js"></script>
</body>
</html>